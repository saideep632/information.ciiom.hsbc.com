<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Subdomain Triage Report — Template</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";margin:0;background:linear-gradient(180deg,#071027 0%,#0b1220 100%);color:#e6eef6;line-height:1.45}
    .container{max-width:980px;margin:36px auto;padding:20px}
    header{display:flex;gap:16px;align-items:center;margin-bottom:18px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:700;color:#042;box-shadow:0 6px 18px rgba(3,7,18,0.6)}
    h1{font-size:20px;margin:0}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    .card{background:linear-gradient(180deg,var(--card), rgba(11,18,32,0.6));padding:16px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}

    label{display:block;font-weight:600;font-size:13px;margin-bottom:6px}
    input[type=text],textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;font-size:13px}
    textarea{min-height:110px;resize:vertical;font-family:mono,ui-monospace,monospace}

    .muted{color:var(--muted);font-size:13px}
    .row{display:flex;gap:10px;align-items:center}
    .btn{background:var(--accent);color:#041122;padding:10px 12px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .small{font-size:13px;padding:8px 10px;border-radius:8px}
    .evidence{background:rgba(2,6,23,0.6);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);overflow:auto;max-height:280px}

    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

    @media (max-width:980px){.grid{grid-template-columns:1fr} .logo{width:48px;height:48px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">SR</div>
      <div>
        <h1>Subdomain Triage Report — Template</h1>
        <p class="lead">Fill the fields below with your non-destructive findings (DNS/HTTP evidence). Generate a compact report for disclosure.</p>
      </div>
    </header>

    <div class="grid">
      <main class="card">
        <label>Target host</label>
        <input id="host" type="text" placeholder="e.g. omanmail.hsbc.com" value="omanmail.hsbc.com">

        <div style="display:flex;gap:10px;margin-top:12px;">
          <div style="flex:1">
            <label>Timestamp (UTC)</label>
            <input id="timestamp" type="text" value="">
          </div>
          <div style="width:120px">
            <label>Severity</label>
            <select id="severity"><option>Low</option><option selected>Medium</option><option>High</option></select>
          </div>
        </div>

        <div style="margin-top:12px">
          <label>DNS output (dig / CNAME / ANY)</label>
          <textarea id="dig" placeholder="Paste dig +short ANY output here"></textarea>
        </div>

        <div style="margin-top:12px">
          <label>HTTP headers (curl -sI)</label>
          <textarea id="headers" placeholder="Paste headers here"></textarea>
        </div>

        <div style="margin-top:12px">
          <label>Body snippet (first 200 lines)</label>
          <textarea id="body" placeholder="Paste body snippet here (non-destructive)"></textarea>
        </div>

        <div style="display:flex;gap:10px;margin-top:12px;align-items:center">
          <button class="btn" id="download">Download JSON Report</button>
          <button class="btn secondary" id="copy">Copy to Clipboard</button>
          <button class="btn secondary" id="clear">Clear</button>
        </div>

        <div style="margin-top:12px" class="muted">Note: Do not include exploit steps or registered resource claims. Keep the report factual and read-only.</div>
      </main>

      <aside class="card">
        <div style="display:flex;justify-content:space-between;align-items:start;gap:10px">
          <div>
            <label>Quick Evidence Preview</label>
            <div class="muted">Shows a trimmed preview of the copied fields below.</div>
          </div>
        </div>

        <div class="evidence" id="preview">
          <strong>Host:</strong> <span id="pv_host">omanmail.hsbc.com</span>
          <hr style="opacity:0.06;margin:8px 0">
          <strong>DNS:</strong>
          <pre id="pv_dig" style="white-space:pre-wrap"></pre>
          <strong>Headers:</strong>
          <pre id="pv_headers" style="white-space:pre-wrap"></pre>
          <strong>Body:</strong>
          <pre id="pv_body" style="white-space:pre-wrap;">(empty)</pre>
        </div>

        <div style="margin-top:12px">
          <label>Suggested disclosure text (short)</label>
          <textarea id="suggested" readonly>Subject: Security report — potential dangling subdomain: omanmail.hsbc.com

I performed non-destructive checks (DNS and HTTP GET only) and observed a CNAME pointing to Cargo Collective and a provider error page that may indicate a dangling resource. Please verify and remediate as appropriate.
</textarea>
        </div>
      </aside>
    </div>

    <footer class="muted">Template created for safe reporting. Do not perform intrusive actions without written authorization.</footer>
  </div>

  <script>
    // initialize timestamp
    document.getElementById('timestamp').value = new Date().toISOString();

    function updatePreview(){
      document.getElementById('pv_host').textContent = document.getElementById('host').value || '(empty)';
      document.getElementById('pv_dig').textContent = (document.getElementById('dig').value || '(empty)');
      document.getElementById('pv_headers').textContent = (document.getElementById('headers').value || '(empty)');
      let b = document.getElementById('body').value || '(empty)';
      if(b.length>1000) b = b.slice(0,1000) + '\n\n...truncated...';
      document.getElementById('pv_body').textContent = b;
    }

    ['host','dig','headers','body'].forEach(id => document.getElementById(id).addEventListener('input', updatePreview));
    updatePreview();

    document.getElementById('clear').addEventListener('click', ()=>{
      ['dig','headers','body'].forEach(id=>document.getElementById(id).value='');
      updatePreview();
    });

    document.getElementById('copy').addEventListener('click', async ()=>{
      const payload = buildReportObject();
      try{
        await navigator.clipboard.writeText(JSON.stringify(payload, null, 2));
        alert('Report JSON copied to clipboard');
      }catch(e){
        alert('Copy failed — select the text and copy manually');
      }
    });

    function buildReportObject(){
      return {
        host: document.getElementById('host').value,
        timestamp: document.getElementById('timestamp').value,
        severity: document.getElementById('severity').value,
        dig: document.getElementById('dig').value,
        headers: document.getElementById('headers').value,
        body_snippet: document.getElementById('body').value,
        note: 'Non-destructive evidence only. Do not include exploit steps.'
      };
    }

    document.getElementById('download').addEventListener('click', ()=>{
      const data = buildReportObject();
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = (data.host||'subdomain-report') + '.json';
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
